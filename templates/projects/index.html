{% extends "base.html" %}
{% load partials %}

{% block page_title %}Home Page{% endblock page_title %}


{% block content %}
  <h1 class="mb-3">Organize it!</h1>
  {% if user.is_authenticated %}
    {% partialdef project-list inline=true %}
      <ul class="list-group list-group-flush vstack gap-2 mb-3"
          hx-swap="outerHTML"
          hx-get="{% url 'projects:project-list' %}"
          hx-trigger="projectSaved from:body">
        {% for project in projects %}
          <li class="list-group-item d-flex">
            <a href="{% url 'projects:project-detail' project.id %}"
               class="flex-grow-1 ">{{ project.title }}</a>
            <button class="btn btn-sm btn-primary ms-3"
                    hx-get="{% url 'projects:project-update' project.id %}"
                    hx-target="#dialog"
                    hx-swap="innerHTML">Update</button>
            <button class="btn btn-sm btn-danger ms-3" type="button"
                    hx-get="{% url 'projects:project-delete' project.id %}"
                    hx-confirm="Are you sure you want to delete {{ project.title }}?">Delete</button>
          </li>
        {% endfor %}
      </ul>
      {% if request.htmx %}
        <div hx-swap-oob=innerHTML:#messages>
          {% include 'includes/messages.html' %}
        </div>
      {% else %}
      {% endif %}
    {% endpartialdef %}
    <button class="btn btn-primary"
            hx-get="{% url 'projects:project-create' %}"
            hx-target="#dialog"
            hx-swap="innerHTML">Create a new project</button>
  {% else %}
    <button class="btn btn-primary"
            hx-get="{% url 'account_login' %}"
            hx-target="#dialog"
            hx-swap="innerHTML">Login</button>
  {% endif %}

{% endblock content %}
