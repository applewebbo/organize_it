{% load i18n trip_tags %}
<div class="mx-auto mt-8 max-w-7xl">
    {% if fav_trip or latest_trip %}
        {% with trip=fav_trip|default:latest_trip %}
            <!-- Trip Detail Section -->
            <section id="details" class="mb-8">
                <div class="shadow card card-border bg-base-100">
                    <div class="card-body">
                        <div class="flex flex-col gap-y-3 items-center mb-3 sm:flex-row">
                            <div class="flex flex-col-reverse items-center md:flex-row grow">
                                <h2 class="mt-0 mb-2 text-2xl font-semibold tracking-tight md:mt-0 md:text-3xl md:me-4">{{ trip.title }}</h2>
                                <span class="mb-2 badge badge-secondary badge-outline badge-sm md:ms-2 lg:badge-md">{{ trip.get_status_display }}</span>
                            </div>
                            <div x-data>
                                <button class="btn btn-md"
                                        hx-get="#"
                                        hx-target="#dialog"
                                        hx-swap="innerHTML"
                                        @click="$dispatch('open-modal'); document.activeElement.blur()"
                                        aria-label="{% trans 'Modify trip dates' %}"
                                        disabled>
                                    <i class="ph-bold ph-pencil-simple i-lg" aria-hidden="true"></i>
                                    <span class="hidden sm:inline">{% trans 'Edit trip' %}</span>
                                </button>
                                <button class="btn btn-md"
                                        hx-get="{% url 'trips:trip-dates' trip.pk %}"
                                        hx-target="#dialog"
                                        hx-swap="innerHTML"
                                        @click="$dispatch('open-modal'); document.activeElement.blur()"
                                        aria-label="{% trans 'Modify trip dates' %}">
                                    <i class="ph-bold ph-calendar-blank i-lg" aria-hidden="true"></i>
                                    <span class="hidden sm:inline">{% trans 'Edit Dates' %}</span>
                                </button>
                            </div>
                        </div>
                        <div id="trip-details"
                             class="flex flex-col gap-x-3 mb-4 md:flex-row lg:gap-x-6 lg:justify-start">
                            {% if trip.start_date and trip.end_date %}
                                <div>
                                    {% trans "Start Date:" %}&nbsp;<strong>{{ trip.start_date }}</strong>
                                </div>
                                <div>
                                    {% trans "End Date:" %}&nbsp;<strong>{{ trip.end_date }}</strong>
                                </div>
                            {% else %}
                                <div>
                                    {% trans "Start Date:" %}&nbsp;<strong>-</strong>
                                </div>
                                <div>
                                    {% trans "End Date:" %}&nbsp;<strong>-</strong>
                                </div>
                            {% endif %}
                            <div class="hidden md:block">
                                {% trans "Destination:" %}&nbsp;<strong>{{ trip.destination }}</strong>
                            </div>
                        </div>
                        <p class="hidden md:block">
                            <em class="text-base-content/80">{{ trip.description }}</em>
                        </p>
                    </div>
                </div>
            </section>
            <!-- Days & Events Section -->
            <section id="days" class="flex flex-col gap-y-4 mb-8">
                {% for day in trip.days.all %}
                    {% include 'trips/includes/day.html' with day=day %}
                {% endfor %}
            </section>
            <!-- Unpaired Events Section -->
            {% if unpaired_events %}
                <section id="unpaired" class="mb-8">
                    <div class="shadow card card-border bg-base-100" x-data>
                        <div class="card-body">
                            <h2 class="text-xl font-medium sm:text-2xl grow">{% trans 'Unpaired Events' %}</h2>
                            <ul class="flex flex-wrap gap-3 justify-center my-4">
                                {% for event in unpaired_events %}
                                    <c-unpaired-event :event="event" :days="trip.days.all" icon="{{ event|event_icon }}" border_color="{{ event|event_border_color }}" bg_color="{{ event|event_bg_color }}" icon_color="{{ event|event_icon_color }}" />
                                {% endfor %}
                            </ul>
                        </div>
                    </div>
                </section>
            {% endif %}
        {% endwith %}
        <!-- Other Trips Section -->
        {% if other_trips %}
            <section id="other-trips" class="mb-8">
                <div class="shadow card card-border bg-base-100">
                    <div class="card-body">
                        <h2 class="text-xl font-semibold">{% trans 'Other Trips' %}</h2>
                        <ul class="list-unstyled">
                            {% for trip in other_trips %}
                                <li>
                                    <a class="link" href="{% url 'trips:trip-detail' trip.id %}">{{ trip.title }}</a>
                                </li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
            </section>
        {% endif %}
    {% else %}
        <p>{% trans 'You have no trips yet!' %}</p>
    {% endif %}
</div>
